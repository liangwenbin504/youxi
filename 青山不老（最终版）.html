<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é’å±±ä¸è€ - é—¯å…³ç»ƒä¹ æ¸¸æˆï¼ˆæœ€ç»ˆæ­£ç¡®ç‰ˆï¼‰</title>
    <style>
        body { font-family: "Microsoft YaHei", sans-serif; max-width: 1000px; margin: 0 auto; padding: 20px; background-color: #f5f9f7; }
        .game-container { background: white; border-radius: 12px; padding: 30px; box-shadow: 0 2px 15px rgba(0,0,0,0.05); }
        .title { text-align: center; color: #2d6a4f; font-size: 26px; margin-bottom: 25px; font-weight: bold; }
        .page { display: none; }
        .page.active { display: block; }
        .question { margin-bottom: 25px; padding: 15px; background: #f8fcf9; border-radius: 8px; }
        .question-title { font-size: 18px; margin-bottom: 15px; color: #2c3e50; font-weight: 500; }
        .question-score { color: #e74c3c; font-size: 14px; margin-left: 10px; font-weight: normal; }
        /* é€‰é¡¹æ ·å¼ */
        .option { margin-bottom: 10px; display: flex; align-items: center; cursor: pointer; padding: 8px 12px; border-radius: 6px; transition: background 0.2s; }
        .option:hover { background: #f0f7f5; }
        .option input { margin-right: 10px; width: 18px; height: 18px; }
        .option label { font-size: 16px; color: #34495e; }
        .option.correct { background: #e8f5e9; color: #27ae60; font-weight: bold; border: 1px solid #c8e6c9; }
        .option.incorrect { background: #ffebee; color: #e74c3c; border: 1px solid #ffcdd2; }
        /* ä¸‹æ‹‰é€‰æ‹©æ ·å¼ */
        .select-group { margin-bottom: 15px; display: flex; align-items: center; gap: 10px; flex-wrap: wrap; }
        .select-group label { font-size: 16px; color: #34495e; min-width: 120px; }
        .select-group select { flex: 1; min-width: 200px; padding: 10px; border: 1px solid #d1e7dd; border-radius: 6px; font-size: 16px; background: white; }
        .select-group select:focus { outline: none; border-color: #2d6a4f; }
        /* æ‹–æ‹½åŒ¹é…æ ·å¼ */
        .drag-container { display: flex; gap: 20px; margin: 15px 0; flex-wrap: wrap; }
        .drag-source, .drop-target { flex: 1; min-width: 250px; padding: 10px; border: 2px dashed #d1e7dd; border-radius: 8px; min-height: 200px; }
        .drag-item { padding: 8px 12px; margin-bottom: 8px; background: white; border-radius: 6px; cursor: move; box-shadow: 0 1px 3px rgba(0,0,0,0.1); transition: transform 0.2s; }
        .drag-item:hover { transform: translateY(-2px); }
        .drop-hint { color: #999; font-style: italic; margin-bottom: 10px; display: block; }
        .drop-item { padding: 8px 12px; margin-bottom: 8px; background: #fafafa; border-radius: 6px; cursor: pointer; border: 1px solid #eee; transition: background 0.2s; }
        .drop-item.hover { background: #e8f5e9; border-color: #2d6a4f; }
        .drop-item.correct { background: #e8f5e9; color: #27ae60; border: 1px solid #c8e6c9; font-weight: bold; }
        .drop-item.incorrect { background: #ffebee; color: #e74c3c; border: 1px solid #ffcdd2; }
        .match-result { display: block; margin-top: 10px; padding: 10px; border-radius: 6px; }
        /* æŒ‰é’®æ ·å¼ - ä¿®æ­£æäº¤æŒ‰é’®é»˜è®¤æ˜¾ç¤º */
        .btn { padding: 12px 30px; border: none; border-radius: 8px; font-size: 16px; cursor: pointer; transition: all 0.3s; margin: 10px 5px; }
        .btn-submit { background: #2d6a4f; color: white; display: inline-block; } /* æ”¹ä¸ºé»˜è®¤æ˜¾ç¤º */
        .btn-submit:hover { background: #1e4d3b; transform: translateY(-2px); }
        .btn-next { 
            background: #f39c12; 
            color: white; 
            display: inline-block !important; 
            font-weight: bold;
            margin-top: 20px; 
        }
        .btn-next.error { 
            background: #e74c3c; 
        }
        .btn-next:hover { background: #e67e22; transform: translateY(-2px); }
        .btn-next.error:hover { background: #c0392b; }
        /* è¿”å›æŒ‰é’®æ ·å¼ */
        .back-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 12px 24px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 30px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            z-index: 1000;
            display: none;
        }
        .back-button:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }
        .back-button:active {
            transform: translateY(0);
        }
        /* åé¦ˆä¸åˆ†æ */
        .feedback { font-size: 24px; margin: 10px 0; display: none; }
        .feedback.ok { color: #27ae60; }
        .feedback.no { color: #e74c3c; }
        .feedback.no::after { content: "ï¼ˆç‚¹å‡»ä¸‹æ–¹ã€Œä¸‹ä¸€é¢˜ã€ç»§ç»­é—¯å…³ï¼‰"; font-size: 14px; display: block; margin-top: 5px; }
        .analysis { margin: 15px 0; padding: 10px; border-radius: 6px; font-size: 15px; line-height: 1.6; display: none; }
        .analysis.correct { background: #e8f5e9; color: #2e7d32; }
        .analysis.incorrect { background: #ffebee; color: #c62828; }
        /* ç»“æœé¡µæ ·å¼ */
        .result-container { text-align: center; padding: 30px; background: #f8fcf9; border-radius: 12px; }
        .result-score { font-size: 28px; color: #2d6a4f; margin: 20px 0; }
        .result-comment { font-size: 18px; color: #34495e; line-height: 1.8; margin: 20px 0; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 1px 5px rgba(0,0,0,0.05); }
        .btn-restart { background: #8e44ad; color: white; margin-top: 20px; }
        .btn-restart:hover { background: #7d3c98; }
        /* é«˜äº®æç¤º */
        .highlight-box { background: #fff8e1; border-left: 4px solid #ffb74d; padding: 10px; margin: 15px 0; border-radius: 4px; }
        /* æŒ‰é’®å®¹å™¨ */
        .btn-container { margin-top: 30px; border-top: 1px dashed #d1e7dd; padding-top: 20px; }
        /* åŒ¹é…å¯¹æ ·å¼ */
        .match-pair { margin-bottom: 10px; display: flex; align-items: center; gap: 10px; flex-wrap: wrap; }
        .match-pair span { font-size: 16px; color: #34495e; min-width: 120px; }
    </style>
</head>
<body>
    <div class="game-container">
        <h1 class="title">é’å±±ä¸è€ Â· é—¯å…³ç»ƒä¹ </h1>

        <!-- ç¬¬1é¡µï¼šQ1 å•é€‰ - è¯»éŸ³åˆ¤æ–­ -->
        <div class="page active" id="page1">
            <div class="question">
                <div class="question-title">ç¬¬1å…³ï¼šä¸‹åˆ—åŠ ç‚¹å­—è¯»éŸ³ä¸æ­£ç¡®çš„æ˜¯å“ªä¸€é¡¹<span class="question-score">(3åˆ†ï¼‰</span></div>
                <div class="option" data-correct="c">
                    <input type="radio" name="q1" id="q1a" onchange="showSubmitBtn('submit1')">
                    <label for="q1a">A. ç¯å¢ƒï¼šç‹‚é£è‚†è™(nÃ¼Ã¨) å¹²æ—±ç›˜è¸(jÃ¹)</label>
                </div>
                <div class="option" data-correct="c">
                    <input type="radio" name="q1" id="q1b" onchange="showSubmitBtn('submit1')">
                    <label for="q1b">B. å·¥å…·ï¼šé“é”¹(qiÄo) æ‹„æ‹æ–(zhÇ”)</label>
                </div>
                <div class="option" data-correct="c">
                    <input type="radio" name="q1" id="q1c" onchange="showSubmitBtn('submit1')">
                    <label for="q1c">C. ç»“æœï¼šç»¿æ ‘åŠ²æŒº(jÃ¬n) ç¢§æ³¢ç²¼ç²¼(lÃ­n)</label>
                </div>
                <div class="option" data-correct="c">
                    <input type="radio" name="q1" id="q1d" onchange="showSubmitBtn('submit1')">
                    <label for="q1d">D. æˆå°±ï¼šè½½å…¥å²å†Œ(zÇi) æ“èµ·é’å±±(qÃ­ng)</label>
                </div>
                <div class="feedback" id="feedback1"></div>
                <div class="analysis" id="analysis1"></div>
                <button class="btn btn-submit" id="submit1" onclick="checkQ1()">æäº¤ç­”æ¡ˆ</button>
                <div class="btn-container">
                    <button class="btn btn-next" id="next1" onclick="switchToPage(2)">ä¸‹ä¸€é¢˜</button>
                </div>
            </div>
        </div>

        <!-- ç¬¬2é¡µï¼šQ2 ä¸‹æ‹‰ - å¡«â€œå¤šâ€çš„è¯è¯­ -->
        <div class="page" id="page2">
            <div class="question">
                <div class="question-title">ç¬¬2å…³ï¼šé€‰æ‹©è¡¨ç¤ºâ€œå¤šâ€çš„å››å­—è¯è¯­ï¼Œè¡¥å…¨äº‹è¿¹<span class="question-score">(6åˆ†ï¼‰</span></div>
                <div class="select-group">
                    <label>å½¢å®¹æ—¶é—´ä¹…ï¼š</label>
                    <select id="q2-1" onchange="checkQ2Ready()">
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="é•¿å¹´ç´¯æœˆ">é•¿å¹´ç´¯æœˆ</option>
                        <option value="ä¸€æœä¸€å¤•">ä¸€æœä¸€å¤•</option>
                        <option value="æ˜™èŠ±ä¸€ç°">æ˜™èŠ±ä¸€ç°</option>
                    </select>
                </div>
                <div class="select-group">
                    <label>å½¢å®¹æ¬¡æ•°å¤šï¼š</label>
                    <select id="q2-2" onchange="checkQ2Ready()">
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="å±¡æ¬¡ä¸‰ç•ª">å±¡æ¬¡ä¸‰ç•ª</option>
                        <option value="ç‹¬ä¸€æ— äºŒ">ç‹¬ä¸€æ— äºŒ</option>
                        <option value="ç»æ— ä»…æœ‰">ç»æ— ä»…æœ‰</option>
                    </select>
                </div>
                <div class="select-group">
                    <label>å½¢å®¹æ•°é‡å¤šï¼š</label>
                    <select id="q2-3" onchange="checkQ2Ready()">
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="ä¸è®¡å…¶æ•°">ä¸è®¡å…¶æ•°</option>
                        <option value="å¯¥å¯¥æ— å‡ ">å¯¥å¯¥æ— å‡ </option>
                        <option value="å±ˆæŒ‡å¯æ•°">å±ˆæŒ‡å¯æ•°</option>
                    </select>
                </div>
                <div class="feedback" id="feedback2"></div>
                <div class="analysis" id="analysis2"></div>
                <button class="btn btn-submit" id="submit2" onclick="checkQ2()">æäº¤ç­”æ¡ˆ</button>
                <div class="btn-container">
                    <button class="btn btn-next" id="next2" onclick="switchToPage(3)">ä¸‹ä¸€é¢˜</button>
                </div>
            </div>
        </div>

        <!-- ç¬¬3é¡µï¼šQ3 æ‹–æ‹½é…å¯¹+å•é€‰ - å¥å­å“è¯» -->
        <div class="page" id="page3">
            <div class="question">
                <div class="question-title">ç¬¬3å…³ï¼šå“è¯»å¥å­ï¼Œå®Œæˆç»ƒä¹ <span class="question-score">(5åˆ†ï¼‰</span></div>
                <div class="highlight-box">
                    â‘ åäº”å¹´å•Šï¼Œç»¿åŒ–äº†å…«æ¡æ²Ÿï¼Œé€ äº†ä¸ƒæ¡é˜²é£æ—å¸¦ã€ä¸‰åƒä¸ƒç™¾äº©æ—ç½‘ï¼Œè¿™æ˜¯å¤šä¹ˆäº†ä¸èµ·çš„å¥‡è¿¹ã€‚â‘¡é’å±±æ˜¯ä¸ä¼šè€çš„ã€‚
                </div>

                <!-- 3a æ‹–æ‹½é…å¯¹ -->
                <div class="question-title" style="font-size:16px; margin-top:15px;">ï¼ˆ1ï¼‰æ‹–æ‹½é…å¯¹ï¼šå°†å·¦ä¾§å†…å®¹æ‹–åˆ°å³ä¾§æ­£ç¡®çš„æè¿°ä¸Šï¼ˆ3åˆ†ï¼‰</div>
                <div class="drag-container">
                    <div class="drag-source">
                        <span class="drop-hint">æ‹–æ‹½æºï¼š</span>
                        <div class="drag-item" draggable="true" data-type="emotion" ondragstart="handleDrag(event)">å¯¹è€äººçš„æƒ…æ„Ÿ</div>
                        <div class="drag-item" draggable="true" data-type="number" ondragstart="handleDrag(event)">æ•°å­—çš„ä½œç”¨</div>
                    </div>
                    <div class="drop-target" id="drop3" ondrop="handleDrop(event)" ondragover="allowDrop(event)" ondragleave="handleDragLeave(event)">
                        <span class="drop-hint">åŒ¹é…ç›®æ ‡ï¼ˆè¯·æ‹–æ‹½å·¦ä¾§å†…å®¹åˆ°æ­£ç¡®é¡¹ï¼‰ï¼š</span>
                        <!-- 2ä¸ªæ­£ç¡®é¡¹ -->
                        <div class="drop-item" data-value="admire">æ•¬ä½©ä¸èµç¾</div>
                        <div class="drop-item" data-value="scale">ä½“ç°æ²»æ²™æ—¶é—´é•¿ã€è§„æ¨¡å¤§</div>
                        <!-- 3ä¸ªå¹²æ‰°é¡¹ -->
                        <div class="drop-item" data-value="age">ä½“ç°è€äººå¹´äº‹å·²é«˜</div>
                        <div class="drop-item" data-value="fear">å¯¹è‡ªç„¶çš„ç•æƒ§å¿ƒç†</div>
                        <div class="drop-item" data-value="cost">è¯´æ˜æ²»æ²™æˆæœ¬ä½å»‰</div>
                    </div>
                </div>

                <!-- 3b å•é€‰ï¼šæ­£ç¡®ç­”æ¡ˆä¸ºBé€‰é¡¹ï¼ˆidä¸ºq3b2ï¼‰ -->
                <div class="question-title" style="font-size:16px; margin-top:20px;">ï¼ˆ2ï¼‰ä¸‹åˆ—å¯¹â€œé’å±±æ˜¯ä¸ä¼šè€çš„â€ç†è§£ä¸æ­£ç¡®çš„æ˜¯ï¼ˆ2åˆ†ï¼‰</div>
                <div class="option" data-correct="B">
                    <input type="radio" name="q3b" id="q3b1" onchange="checkQ3Ready()">
                    <label for="q3b1">A. â€œé’å±±â€è¡¨é¢ä¸ŠæŒ‡è€äººç§æ ‘çš„å¥‡è¿¹</label>
                </div>
                <div class="option" data-correct="B">
                    <input type="radio" name="q3b" id="q3b2" onchange="checkQ3Ready()">
                    <label for="q3b2">B. è¡¨è¾¾å¯¹è‡ªç„¶ä¸‡ç‰©ç”Ÿç”Ÿä¸æ¯çš„èµé¢‚</label>
                </div>
                <div class="option" data-correct="B">
                    <input type="radio" name="q3b" id="q3b3" onchange="checkQ3Ready()">
                    <label for="q3b3">C. â€œé’å±±â€è±¡å¾è€äººçš„ç²¾ç¥åƒé’å±±ä¸€æ ·å……æ»¡ç”Ÿæœº</label>
                </div>
                <div class="option" data-correct="B">
                    <input type="radio" name="q3b" id="q3b4" onchange="checkQ3Ready()">
                    <label for="q3b4">D. é¥±å«å¯¹é€ æ—è‹±é›„çš„æ•¬ä½©å’Œç¥ç¦</label>
                </div>

                <div class="feedback" id="feedback3"></div>
                <div class="analysis" id="analysis3"></div>
                <button class="btn btn-submit" id="submit3" onclick="checkQ3()">æäº¤ç­”æ¡ˆ</button>
                <div class="btn-container">
                    <button class="btn btn-next" id="next3" onclick="switchToPage(4)">ä¸‹ä¸€é¢˜</button>
                </div>
            </div>
        </div>

        <!-- ç¬¬4é¡µï¼šQ4 é€‰æ‹©+å¤šé€‰ - éƒ­ä¸‡åˆšæ•…äº‹ -->
        <div class="page" id="page4">
            <div class="question">
                <div class="question-title">ç¬¬4å…³ï¼šé˜…è¯»éƒ­ä¸‡åˆšæ•…äº‹ï¼Œå®Œæˆç»ƒä¹ <span class="question-score">(11åˆ†ï¼‰</span></div>
                <div class="highlight-box">
                    åˆšå¼€å§‹ï¼Œæ²¡æœ‰èµ„é‡‘ï¼Œæ²¡æœ‰ç»éªŒï¼Œä»–å°±ç”¨â€œä¸€é•¢æ²™ã€ä¸€æ£µæ ‘â€çš„åœŸåŠæ³•é€ æ—ã€‚å¯æ²¡æƒ³åˆ°ï¼Œå‡ åœºå¤§é£é“ºå¤©ç›–åœ°åˆ®è¿‡ï¼Œè¿‘ä¸€åŠçš„æ ‘è‹—å°±è¢«æ²™å­åŸ‹æ‰äº†ã€‚æ”¶æ‹¾ç€é£å¹²çš„æ­»æ ‘è‹—ï¼Œéƒ­ä¸‡åˆšå¿ƒé‡Œä¸æ˜¯ä¸ªæ»‹å‘³ã€‚ä½†æœ›ç€é‚£äº›å‘èŠ½çš„æ´»æ ‘è‹—ï¼Œä»–å¹¶æ²¡æœ‰ç°å¿ƒï¼šâ€œåªè¦æœ‰æ´»çš„è‹—ï¼Œå°±è¯´æ˜è¿™ä¸ªæ²™èƒ½æ²»ï¼â€ç»è¿‡åå¤æ‘¸ç´¢ï¼Œä»–ç»ˆäºæ€»ç»“å‡ºäº†â€œä¸€æ£µæ ‘ï¼Œä¸€æŠŠè‰ï¼Œå‹ä½æ²™å­é˜²é£æâ€çš„æ²»æ²™æ–¹æ³•ã€‚<br>
                    æ˜¥ç§‹æ—¶èŠ‚ï¼Œæ˜¯å‹æ²™æ ½æ ‘çš„é»„é‡‘æœŸã€‚ä¸ºäº†èµ¶è¿›åº¦ï¼Œéƒ­ä¸‡åˆšç´¢æ€§å·èµ·é“ºç›–ä½è¿›æ²™çªé‡Œã€‚æ²¡æœ‰æˆ¿å­ï¼Œä»–å°±åœ¨æ²™åœ°ä¸ŠæŒ–ä¸ªå£•æ²Ÿï¼Œç”¨æŸ´è‰æ­å‡ºä¸ªåœ°çªæ£šä½ï¼›æ²¡æœ‰ç‚‰å­ï¼Œå°±ç”¨ä¸‰å—çŸ³å¤´æ”¯å£é”…ï¼Œå¼€æ°´æ³¡é¦å½“é¥­åƒã€‚å¤§é£ä¸€èµ·ï¼Œæ²™å­åˆ®åˆ°ä»–é”…ç¢—é‡Œï¼Œåƒåˆ°å˜´é‡Œï¼ŒæŠŠç‰™ç£¨å¾—å±å±å“ã€‚
                </div>

                <!-- 4a é€‰æ‹©æ–¹æ³• -->
                <div class="question-title" style="font-size:16px; margin-top:15px;">ï¼ˆ1ï¼‰é€‰æ‹©éƒ­ä¸‡åˆšå…‹æœå›°éš¾çš„æ–¹æ³•ï¼ˆ6åˆ†ï¼‰</div>
                <div class="match-pair">
                    <span>â‘  æ ‘è‹—è¢«åŸ‹ï¼š</span>
                    <select id="q4-1" onchange="checkQ4Ready()">
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="correct">æ€»ç»“â€œä¸€æ£µæ ‘ï¼Œä¸€æŠŠè‰â€çš„æ²»æ²™æ–¹æ³•</option>
                        <option value="wrong1">æ”¾å¼ƒæ²»æ²™ï¼Œç­‰æ”¿åºœæ”¯æ´</option>
                        <option value="wrong2">æ¢ä¸ªåœ°æ–¹é‡æ–°é€ æ—</option>
                        <option value="wrong3">åªåœ¨æ— é£å­£èŠ‚æ ½ç§æ ‘è‹—</option>
                        <option value="wrong4">è¯·æ±‚ä¸“å®¶å›¢é˜Ÿç°åœºæŒ‡å¯¼</option>
                        <option value="wrong5">æ”¹ç”¨æ›´æ˜‚è´µçš„è¿›å£æ ‘è‹—</option>
                    </select>
                </div>
                <div class="match-pair">
                    <span>â‘¡ æ²¡æœ‰æˆ¿å­ï¼š</span>
                    <select id="q4-2" onchange="checkQ4Ready()">
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="wrong1">ä½æ‘æ°‘å®¶è¹­ä½</option>
                        <option value="correct">æŒ–å£•æ²Ÿï¼Œæ­æŸ´è‰åœ°çªæ£š</option>
                        <option value="wrong2">ç›–ç®€æ˜“æœ¨æ¿æˆ¿</option>
                        <option value="wrong3">æ­å»ºå¸ç¯·æŠµå¾¡é£æ²™</option>
                        <option value="wrong4">è½®æµå›æ‘å±…ä½å€¼ç­</option>
                        <option value="wrong5">å‘æ‘å§”ä¼šç”³è¯·ä¸´æ—¶ä½æˆ¿</option>
                    </select>
                </div>
                <div class="match-pair">
                    <span>â‘¢ æ²¡æœ‰ç‚‰å­ï¼š</span>
                    <select id="q4-3" onchange="checkQ4Ready()">
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="wrong1">åƒå†·å¹²ç²®å……é¥¥</option>
                        <option value="wrong2">å€Ÿæ‘æ°‘ç‚‰å­åšé¥­</option>
                        <option value="correct">ä¸‰å—çŸ³å¤´æ”¯é”…ï¼Œå¼€æ°´æ³¡é¦</option>
                        <option value="wrong3">æ¡æ¯æç”Ÿç«å–æš–åšé¥­</option>
                        <option value="wrong4">æ¯å¤©å¾€è¿”æ‘é‡Œåƒé¥­</option>
                        <option value="wrong5">ç”¨ä¾¿æºç…¤æ°”ç‚‰åšé¥­</option>
                    </select>
                </div>

                <!-- 4b ç¯å¢ƒåˆ†æ -->
                <div class="question-title" style="font-size:16px; margin-top:20px;">ï¼ˆ2ï¼‰ç¯å¢ƒæå†™åˆ†æï¼ˆ5åˆ†ï¼‰</div>
                <div class="question-title" style="font-size:14px; color:#666;">â‘  é€‰å‡ºç¯å¢ƒæ¶åŠ£çš„è¯­å¥ï¼ˆ1åˆ†ï¼‰</div>
                <div class="option" data-correct="C">
                    <input type="radio" name="q4b1" id="q4b1a" onchange="checkQ4Ready()">
                    <label for="q4b1a">A. æ˜¥ç§‹æ—¶èŠ‚ï¼Œæ˜¯å‹æ²™æ ½æ ‘çš„é»„é‡‘æœŸ</label>
                </div>
                <div class="option" data-correct="C">
                    <input type="radio" name="q4b1" id="q4b1b" onchange="checkQ4Ready()">
                    <label for="q4b1b">B. ä»–å¹¶æ²¡æœ‰ç°å¿ƒï¼š"åªè¦æœ‰æ´»çš„è‹—ï¼Œå°±è¯´æ˜è¿™ä¸ªæ²™èƒ½æ²»ï¼"</label>
                </div>
                <div class="option" data-correct="C">
                    <input type="radio" name="q4b1" id="q4b1c" onchange="checkQ4Ready()">
                    <label for="q4b1c">C. å‡ åœºå¤§é£é“ºå¤©ç›–åœ°åˆ®è¿‡ï¼Œè¿‘ä¸€åŠçš„æ ‘è‹—è¢«åŸ‹ï¼›æ²™å­åˆ®åˆ°é”…ç¢—é‡Œ</label>
                </div>
                <div class="option" data-correct="C">
                    <input type="radio" name="q4b1" id="q4b1d" onchange="checkQ4Ready()">
                    <label for="q4b1d">D. ç»è¿‡åå¤æ‘¸ç´¢ï¼Œä»–ç»ˆäºæ€»ç»“å‡ºäº†æ²»æ²™æ–¹æ³•</label>
                </div>
                <div class="option" data-correct="C">
                    <input type="radio" name="q4b1" id="q4b1e" onchange="checkQ4Ready()">
                    <label for="q4b1e">E. å·èµ·é“ºç›–ä½è¿›æ²™çªé‡Œï¼Œèµ¶è¿›åº¦æ ½ç§æ ‘è‹—</label>
                </div>
                
                <div class="question-title" style="font-size:14px; color:#666; margin-top:10px;">â‘¡ é€‰å‡ºç¯å¢ƒæå†™çš„å¥½å¤„ï¼ˆ4åˆ†ï¼Œå¤šé€‰ï¼‰</div>
                <div style="display: flex; flex-wrap: wrap; gap: 15px; margin: 10px 0;">
                    <label style="display: flex; align-items: center; gap: 5px;">
                        <input type="checkbox" name="q4b2" value="difficulty" onchange="checkQ4Ready()"> çªå‡ºæ²»æ²™è‰°éš¾
                    </label>
                    <label style="display: flex; align-items: center; gap: 5px;">
                        <input type="checkbox" name="q4b2" value="character" onchange="checkQ4Ready()"> è¡¬æ‰˜äººç‰©å“è´¨
                    </label>
                    <label style="display: flex; align-items: center; gap: 5px;">
                        <input type="checkbox" name="q4b2" value="image" onchange="checkQ4Ready()"> è®©äººç‰©å½¢è±¡æ›´é²œæ˜
                    </label>
                    <label style="display: flex; align-items: center; gap: 5px;">
                        <input type="checkbox" name="q4b2" value="wrong1" onchange="checkQ4Ready()"> è¯´æ˜è‡ªç„¶ç¯å¢ƒä¸å¯æˆ˜èƒœ
                    </label>
                    <label style="display: flex; align-items: center; gap: 5px;">
                        <input type="checkbox" name="q4b2" value="wrong2" onchange="checkQ4Ready()"> æš—ç¤ºæ²»æ²™æ³¨å®šå¤±è´¥
                    </label>
                    <label style="display: flex; align-items: center; gap: 5px;">
                        <input type="checkbox" name="q4b2" value="wrong3" onchange="checkQ4Ready()"> å¼ºè°ƒæ²™å­è´¨é‡ä¸å¥½
                    </label>
                </div>

                <div class="feedback" id="feedback4"></div>
                <div class="analysis" id="analysis4"></div>
                <button class="btn btn-submit" id="submit4" onclick="checkQ4()">æäº¤ç­”æ¡ˆ</button>
                <div class="btn-container">
                    <button class="btn btn-next" id="next4" onclick="switchToPage(5)">æŸ¥çœ‹ç»“æœ</button>
                </div>
            </div>
        </div>

        <!-- ç¬¬5é¡µï¼šç»“æœé¡µ -->
        <div class="page" id="page5">
            <div class="result-container">
                <h2 class="title">é—¯å…³ç»“æŸï¼ä½ çš„æˆ˜ç»©æ¥å•¦~</h2>
                <div class="result-score" id="finalScore">æ€»åˆ†ï¼š0/25 åˆ†</div>
                <div class="result-comment" id="resultComment">
                    <!-- å¹½é»˜è¯„ä»·å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                </div>
                <button class="btn btn-restart" onclick="restartGame()">é‡æ–°é—¯å…³</button>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡ï¼šç´¯è®¡å¾—åˆ†ã€æ‹–æ‹½é…å¯¹ç»“æœ
        let totalScore = 0;
        let dragResult = { emotion: null, number: null }; // å­˜å‚¨æ‹–æ‹½é…å¯¹ç»“æœ

        // æ­£ç¡®ç­”æ¡ˆåº“
        const answerBank = {
            q1: { correct: "c", analysis: "â€œç»¿æ ‘åŠ²æŒºâ€çš„â€œåŠ²â€è¡¨â€œåšå¼ºæœ‰åŠ›â€æ—¶è¯»jÃ¬ngï¼Œä¸æ˜¯jÃ¬nå“¦ï¼å…¶ä»–é€‰é¡¹è¯»éŸ³éƒ½å¯¹ï¼Œä¸‹æ¬¡åˆ«è®©å¤šéŸ³å­—éª—å•¦~" },
            q2: {
                1: { correct: "é•¿å¹´ç´¯æœˆ", analysis: "â€œé•¿å¹´ç´¯æœˆâ€æ‰æ˜¯â€œæ—¶é—´ä¹…â€ï¼Œâ€œä¸€æœä¸€å¤•â€æ˜¯æ—¶é—´çŸ­ï¼Œä½ æ€•ä¸æ˜¯æŠŠâ€œæ²»æ²™â€å½“æˆâ€œé—ªç”µæˆ˜â€äº†ï¼Ÿ" },
                2: { correct: "å±¡æ¬¡ä¸‰ç•ª", analysis: "â€œå±¡æ¬¡ä¸‰ç•ªâ€æ˜¯â€œæ¬¡æ•°å¤šâ€ï¼Œé€‰â€œç‹¬ä¸€æ— äºŒâ€çš„è¯ï¼Œæ²™å­éƒ½å¾—ç¬‘ä½ ï¼šâ€œæˆ‘æ˜æ˜ç»å¸¸æ¥æ£ä¹±å•Šï¼â€" },
                3: { correct: "ä¸è®¡å…¶æ•°", analysis: "æ ‘è‹—æ•°é‡å¤šåˆ°â€œä¸è®¡å…¶æ•°â€ï¼Œé€‰â€œå¯¥å¯¥æ— å‡ â€çš„è¯ï¼Œè€äººå¯è¦ç€æ€¥è¡¥ç§å•¦ï¼" }
            },
            q3: {
                a: { 
                    correct: { emotion: "admire", number: "scale" }, // æ‹–æ‹½æ­£ç¡®é…å¯¹ï¼šemotionâ†’admireï¼Œnumberâ†’scale
                    analysis: "æ‹–æ‹½é…å¯¹é”™å•¦ï¼â€œå¯¹è€äººçš„æƒ…æ„Ÿâ€å¯¹åº”â€œæ•¬ä½©ä¸èµç¾â€ï¼Œâ€œæ•°å­—çš„ä½œç”¨â€å¯¹åº”â€œä½“ç°æ²»æ²™æ—¶é—´é•¿ã€è§„æ¨¡å¤§â€å“¦~" 
                },
                b: { correct: "2", analysis: "â€œé’å±±ä¸è€â€çš„æ ¸å¿ƒæ˜¯èµç¾è€äººçš„å¥‰çŒ®ç²¾ç¥ï¼Œè€Œéå•çº¯èµé¢‚è‡ªç„¶ä¸‡ç‰©çš„ç”Ÿç”Ÿä¸æ¯ï¼Œä½ ç†è§£åå•¦~" }
            },
            q4: {
                1: { correct: "correct", analysis: "éƒ­ä¸‡åˆšå¯æ˜¯â€œæ²»æ²™å°èƒ½æ‰‹â€ï¼Œå“ªä¼šè½»æ˜“æ”¾å¼ƒï¼Ÿæ€»ç»“æ–¹æ³•æ‰æ˜¯ç‹é“ï¼" },
                2: { correct: "correct", analysis: "æŒ–å£•æ²Ÿæ­çªæ£šï¼Œè¿™åƒè‹¦ç²¾ç¥ï¼Œæ²™å­çœ‹äº†éƒ½å¾—ç»•ç€èµ°ï¼" },
                3: { correct: "correct", analysis: "ä¸‰å—çŸ³å¤´æ”¯é”…ï¼Œå¼€æ°´æ³¡é¦ï¼Œè¿™å°±æ˜¯æ²»æ²™äººçš„â€œè’é‡æ±‚ç”Ÿâ€ï¼" },
                b: { 
                    correct1: "c", 
                    correct2: ["difficulty", "character", "image"], 
                    analysis: "ç¯å¢ƒæå†™æ˜¯â€œèƒŒæ™¯æ¿â€ï¼Œä¸“é—¨è¡¬æ‰˜éƒ­ä¸‡åˆšçš„ç‰›ï¼æ²¡é€‰å…¨çš„è¯ï¼Œå†å“å“è¯¾æ–‡~" 
                }
            }
        };

        // 1. æ˜¾ç¤ºæäº¤æŒ‰é’®ï¼ˆé€‰æ‹©ç­”æ¡ˆåä¿æŒæ˜¾ç¤ºï¼‰
        function showSubmitBtn(btnId) {
            const submitBtn = document.getElementById(btnId);
            if (submitBtn) submitBtn.style.display = "inline-block";
        }

        // 2. é¡µé¢åˆ‡æ¢æ ¸å¿ƒå‡½æ•°
        function switchToPage(targetPageNum) {
            document.querySelectorAll(".page").forEach(page => {
                page.classList.remove("active");
            });
            const targetPage = document.getElementById(`page${targetPageNum}`);
            if (targetPage) {
                targetPage.classList.add("active");
                window.scrollTo({ top: 0, behavior: "smooth" });
            }
            if (targetPageNum === 5) {
                showFinalResult();
            }
        }

        // 3. æ˜¾ç¤ºæœ€ç»ˆç»“æœ
        function showFinalResult() {
            document.getElementById("finalScore").textContent = `æ€»åˆ†ï¼š${totalScore}/25 åˆ†`;
            const commentEl = document.getElementById("resultComment");
            let comment = "";
            if (totalScore === 25) {
                comment = "ğŸ‰ æ»¡åˆ†ï¼ä½ æ€•ä¸æ˜¯å·å·å»è·Ÿç€è€äººæ²»è¿‡æ²™å§ï¼Ÿè¿ç»†èŠ‚éƒ½æ‹¿æå¾—æ­»æ­»çš„ï¼Œè€äººçœ‹äº†éƒ½å¾—æ‹ä½ è‚©è†€è¯´ï¼šâ€œè¿™å¾’å¼Ÿæˆ‘æ”¶äº†ï¼â€ä»¥åæ²»æ²™é˜Ÿæ²¡ä½ ä¸è¡Œ~";
            } else if (totalScore >= 20) {
                comment = "ğŸ‘ å·®ä¸€ç‚¹æ»¡åˆ†ï¼æ²»æ²™çŸ¥è¯†æŒæ¡å¾—å·®ä¸å¤šäº†ï¼Œå°±æ˜¯å¶å°”æ‰‹æŠ–é€‰é”™ã€‚ä¸‹æ¬¡ä»”ç»†ç‚¹ï¼Œä½ å°±æ˜¯ä¸‹ä¸€ä¸ªâ€œé’å±±å®ˆæŠ¤è€…â€ï¼Œæ²™å­è§äº†ä½ éƒ½å¾—ç»•è·¯èµ°ï¼";
            } else if (totalScore >= 15) {
                comment = "ğŸ‘ ä¸­ç­‰åä¸Šï¼ä½ å¯¹é’å±±çš„æ„Ÿæƒ…åˆ°ä½äº†ï¼Œä½†çŸ¥è¯†ç‚¹è¿˜æ²¡å®Œå…¨åƒé€ã€‚å¤šè¯»è¯»è¯¾æ–‡ï¼Œä¸‹æ¬¡äº‰å–è®©è€äººéƒ½å¤¸ä½ â€œæ‡‚è¡Œâ€ï¼";
            } else if (totalScore >= 10) {
                comment = "ğŸ˜… åˆšåŠæ ¼è¾¹ç¼˜ï¼ä½ å¯èƒ½å’Œæ²™å­æ›´ç†Ÿä¸€ç‚¹ï¼Œå’Œé’å±±è¿˜å·®ç‚¹ç¼˜åˆ†ã€‚å†ç¢ç£¨ç¢ç£¨è¯¾æ–‡ï¼Œä¸‹æ¬¡åˆ«è®©æ²™å­ç¬‘è¯ä½ â€œä¸æ‡‚æ²»æ²™â€å•¦ï¼";
            } else {
                comment = "ğŸ˜‚ å“å‘€ï¼Œçœ‹æ¥ä½ è¿˜æ²¡å’Œé’å±±â€œè®¤äº²â€æˆåŠŸï¼æ˜¯ä¸æ˜¯æŠŠæ²»æ²™å½“æˆå †æ²™å­ç©äº†ï¼Ÿèµ¶ç´§ç¿»è¯¾æ–‡è¡¥è¯¾ï¼Œä¸ç„¶è€äººå¯è¦ç€æ€¥å–Šä½ â€œå†å­¦å­¦â€å•¦ï¼";
            }
            commentEl.textContent = comment;
            // æ¸¸æˆç»“æŸï¼Œæ˜¾ç¤ºè¿”å›æŒ‰é’®
            document.getElementById('back-btn').style.display = 'block';
        }

        // 4. Q1 æäº¤å¤„ç†
        function checkQ1() {
            const checkedRadio = document.querySelector('input[name="q1"]:checked');
            const feedbackEl = document.getElementById("feedback1");
            const analysisEl = document.getElementById("analysis1");
            const submitBtn = document.getElementById("submit1");
            const nextBtn = document.getElementById("next1");

            if (!checkedRadio) {
                alert("è¯·å…ˆé€‰æ‹©ä¸€ä¸ªç­”æ¡ˆå†æäº¤å“¦ï¼");
                return;
            }

            const userChoice = checkedRadio.id.slice(-1);
            const isCorrect = userChoice === answerBank.q1.correct;

            submitBtn.style.display = "none";
            feedbackEl.style.display = "block";
            if (isCorrect) {
                feedbackEl.innerHTML = "âœ… å›ç­”æ­£ç¡®ï¼ä½ è¿™è¯»éŸ³æ‹¿æå¾—å¾ˆç¨³~";
                feedbackEl.className = "feedback ok";
                totalScore += 3;
                nextBtn.classList.remove("error");
            } else {
                feedbackEl.innerHTML = "âŒ å›ç­”é”™è¯¯ï¼å†è·Ÿå¤šéŸ³å­—è¾ƒè¾ƒåŠ²~";
                feedbackEl.className = "feedback no";
                document.getElementById(`q1${userChoice}`).parentNode.classList.add("incorrect");
                document.getElementById(`q1${answerBank.q1.correct}`).parentNode.classList.add("correct");
                nextBtn.classList.add("error");
            }
            analysisEl.style.display = "block";
            analysisEl.className = isCorrect ? "analysis correct" : "analysis incorrect";
            analysisEl.textContent = answerBank.q1.analysis;
        }

        // 5. Q2 æäº¤å¤„ç†
        function checkQ2Ready() {
            const s1 = document.getElementById("q2-1").value;
            const s2 = document.getElementById("q2-2").value;
            const s3 = document.getElementById("q2-3").value;
            const submitBtn = document.getElementById("submit2");
            if (s1 && s2 && s3 && submitBtn) {
                submitBtn.style.display = "inline-block";
            }
        }

        function checkQ2() {
            const s1 = document.getElementById("q2-1").value;
            const s2 = document.getElementById("q2-2").value;
            const s3 = document.getElementById("q2-3").value;
            const feedbackEl = document.getElementById("feedback2");
            const analysisEl = document.getElementById("analysis2");
            const submitBtn = document.getElementById("submit2");
            const nextBtn = document.getElementById("next2");

            if (!s1 || !s2 || !s3) {
                alert("è¯·æŠŠä¸‰ä¸ªä¸‹æ‹‰æ¡†éƒ½é€‰æ‹©å®Œæˆå†æäº¤å“¦ï¼");
                return;
            }

            const isCorrect1 = s1 === answerBank.q2[1].correct;
            const isCorrect2 = s2 === answerBank.q2[2].correct;
            const isCorrect3 = s3 === answerBank.q2[3].correct;
            const totalCorrect = [isCorrect1, isCorrect2, isCorrect3].filter(Boolean).length;
            totalScore += totalCorrect * 2;
            const isAllCorrect = totalCorrect === 3;

            submitBtn.style.display = "none";
            feedbackEl.style.display = "block";
            if (isAllCorrect) {
                feedbackEl.innerHTML = "âœ… å…¨å¯¹ï¼ä½ è¿™â€œå¤šâ€ä¹‰è¯æŒæ¡å¾—æ¯”æ²™å­è¿˜å¤š~";
                feedbackEl.className = "feedback ok";
                nextBtn.classList.remove("error");
            } else {
                feedbackEl.innerHTML = `âŒ å¯¹äº†${totalCorrect}ä¸ªï¼å†ç¢ç£¨ç¢ç£¨â€œå¤šâ€çš„æ„æ€~`;
                feedbackEl.className = "feedback no";
                nextBtn.classList.add("error");
            }
            analysisEl.style.display = "block";
            analysisEl.className = isAllCorrect ? "analysis correct" : "analysis incorrect";
            let analysisText = "";
            if (!isCorrect1) analysisText += answerBank.q2[1].analysis + "\n";
            if (!isCorrect2) analysisText += answerBank.q2[2].analysis + "\n";
            if (!isCorrect3) analysisText += answerBank.q2[3].analysis;
            analysisEl.textContent = analysisText;
        }

        // 6. æ‹–æ‹½äº¤äº’æ ¸å¿ƒå‡½æ•°
        function allowDrop(ev) {
            ev.preventDefault();
            // æ‹–æ‹½æ‚¬åœæ—¶é«˜äº®ç›®æ ‡é¡¹
            if (ev.target.classList.contains('drop-item')) {
                ev.target.classList.add('hover');
            }
        }

        function handleDrag(ev) {
            // ä¼ é€’æ‹–æ‹½é¡¹çš„ç±»å‹ï¼ˆemotion/numberï¼‰
            ev.dataTransfer.setData("text", ev.target.dataset.type);
        }

        function handleDragLeave(ev) {
            // ç¦»å¼€æ—¶ç§»é™¤é«˜äº®ï¼Œä½†ä¿ç•™å·²ç»è¢«æ‹–æ”¾åˆ°çš„é¡¹çš„correctçŠ¶æ€
            if (ev.target.classList.contains('drop-item') && !ev.target.classList.contains('correct')) {
                ev.target.classList.remove('hover');
            }
        }

        function handleDrop(ev) {
            ev.preventDefault();
            const dragType = ev.dataTransfer.getData("text");
            const dropItem = ev.target;

            // ä»…å…è®¸æ‹–åˆ°drop-itemä¸Š
            if (!dropItem.classList.contains('drop-item')) return;

            // ç§»é™¤å½“å‰ç±»å‹ä¹‹å‰å¯èƒ½æ‹–æ”¾çš„é¡¹çš„çŠ¶æ€
            document.querySelectorAll('.drop-item').forEach(item => {
                // åªç§»é™¤æœªè¢«é€‰ä¸­æˆ–ä¸å½“å‰ç±»å‹æ— å…³çš„é¡¹çš„çŠ¶æ€
                if (dragResult[dragType] === item.dataset.value) {
                    item.classList.remove('correct', 'incorrect');
                }
                item.classList.remove('hover');
            });

            // è®°å½•æ‹–æ‹½ç»“æœ
            dragResult[dragType] = dropItem.dataset.value;
            // æ ‡è®°æ‹–æ‹½ä½ç½®å¹¶ä¿æŒæ˜¾ç¤ºçŠ¶æ€
            dropItem.classList.add('correct');

            // æ£€æŸ¥æ˜¯å¦å¯ä»¥æ˜¾ç¤ºæäº¤æŒ‰é’®
            checkQ3Ready();
        }

        // 7. Q3 æäº¤å¤„ç†
        function checkQ3Ready() {
            // æ‹–æ‹½é¡¹æ˜¯å¦éƒ½å·²æ”¾ç½® + å•é€‰é¢˜æ˜¯å¦å·²é€‰æ‹©
            const isDragComplete = dragResult.emotion && dragResult.number;
            const isRadioSelected = document.querySelector('input[name="q3b"]:checked');
            const submitBtn = document.getElementById("submit3");
            
            if (isDragComplete && isRadioSelected && submitBtn) {
                submitBtn.style.display = "inline-block";
            }
        }

        function checkQ3() {
            // éªŒè¯æ‹–æ‹½é…å¯¹
            const isDragCorrect = dragResult.emotion === answerBank.q3.a.correct.emotion && 
                                 dragResult.number === answerBank.q3.a.correct.number;
            const dragScore = isDragCorrect ? 3 : 0;

            // éªŒè¯å•é€‰é¢˜
            const checkedRadio = document.querySelector('input[name="q3b"]:checked');
            const isRadioCorrect = checkedRadio ? checkedRadio.id.slice(-1) === answerBank.q3.b.correct : false;
            const radioScore = isRadioCorrect ? 2 : 0;

            // æ€»åˆ†è®¡ç®—
            totalScore += dragScore + radioScore;
            const isAllCorrect = isDragCorrect && isRadioCorrect;

            // æ›´æ–°UI
            const feedbackEl = document.getElementById("feedback3");
            const analysisEl = document.getElementById("analysis3");
            const submitBtn = document.getElementById("submit3");
            const nextBtn = document.getElementById("next3");

            submitBtn.style.display = "none";
            feedbackEl.style.display = "block";
            if (isAllCorrect) {
                feedbackEl.innerHTML = "âœ… å…¨å¯¹ï¼ä½ å¯¹å¥å­çš„å“è¯»æ¯”é’å±±è¿˜é€å½»~";
                feedbackEl.className = "feedback ok";
                nextBtn.classList.remove("error");
            } else {
                feedbackEl.innerHTML = `âŒ æ‹–æ‹½å¯¹äº†${isDragCorrect ? '3åˆ†' : '0åˆ†'}ï¼Œå•é€‰é¢˜å¯¹äº†${isRadioCorrect ? '2åˆ†' : '0åˆ†'}~`;
                feedbackEl.className = "feedback no";
                nextBtn.classList.add("error");
            }

            // æ˜¾ç¤ºæ‹–æ‹½æ­£ç¡®/é”™è¯¯çŠ¶æ€
            document.querySelectorAll('.drop-item').forEach(item => {
                if ((item.dataset.value === answerBank.q3.a.correct.emotion && dragResult.emotion === item.dataset.value) ||
                    (item.dataset.value === answerBank.q3.a.correct.number && dragResult.number === item.dataset.value)) {
                    item.classList.add('correct');
                } else if (item.dataset.value === dragResult.emotion || item.dataset.value === dragResult.number) {
                    item.classList.add('incorrect');
                }
            });

            // æ˜¾ç¤ºå•é€‰é¢˜æ­£ç¡®/é”™è¯¯çŠ¶æ€
            if (checkedRadio && !isRadioCorrect) {
                checkedRadio.parentNode.classList.add('incorrect');
                document.getElementById(`q3b${answerBank.q3.b.correct}`).parentNode.classList.add('correct');
            }

            analysisEl.style.display = "block";
            analysisEl.className = isAllCorrect ? "analysis correct" : "analysis incorrect";
            analysisEl.textContent = !isDragCorrect ? answerBank.q3.a.analysis : (isRadioCorrect ? "" : answerBank.q3.b.analysis);
        }

        // 8. Q4 æäº¤å¤„ç†
        function checkQ4Ready() {
            // æ£€æŸ¥æ‰€æœ‰ä¸‹æ‹‰æ¡†å’Œå•é€‰ã€å¤šé€‰æ˜¯å¦å·²é€‰æ‹©
            const s1 = document.getElementById("q4-1").value;
            const s2 = document.getElementById("q4-2").value;
            const s3 = document.getElementById("q4-3").value;
            const radioChecked = document.querySelector('input[name="q4b1"]:checked');
            const checkboxesChecked = document.querySelectorAll('input[name="q4b2"]:checked').length > 0;
            
            const submitBtn = document.getElementById("submit4");
            if (s1 && s2 && s3 && radioChecked && checkboxesChecked && submitBtn) {
                submitBtn.style.display = "inline-block";
            }
        }

        function checkQ4() {
            // éªŒè¯ä¸‹æ‹‰é€‰æ‹©é¢˜ï¼ˆ6åˆ†ï¼‰
            const s1Correct = document.getElementById("q4-1").value === answerBank.q4[1].correct;
            const s2Correct = document.getElementById("q4-2").value === answerBank.q4[2].correct;
            const s3Correct = document.getElementById("q4-3").value === answerBank.q4[3].correct;
            const selectScore = (s1Correct ? 2 : 0) + (s2Correct ? 2 : 0) + (s3Correct ? 2 : 0);

            // éªŒè¯ç¯å¢ƒæå†™å•é€‰é¢˜ï¼ˆ1åˆ†ï¼‰
            const radioChecked = document.querySelector('input[name="q4b1"]:checked');
            const radioCorrect = radioChecked ? radioChecked.id.slice(-1) === answerBank.q4.b.correct1 : false;
            const radioScore = radioCorrect ? 1 : 0;

            // éªŒè¯å¤šé€‰é¢˜ï¼ˆ4åˆ†ï¼‰
            const checkboxes = document.querySelectorAll('input[name="q4b2"]:checked');
            const selectedValues = Array.from(checkboxes).map(cb => cb.value);
            const correctValues = answerBank.q4.b.correct2;
            const isAllChecked = correctValues.every(v => selectedValues.includes(v));
            const noExtraChecked = selectedValues.every(v => correctValues.includes(v));
            const checkboxScore = (isAllChecked && noExtraChecked) ? 4 : 0;

            // æ€»åˆ†è®¡ç®—
            totalScore += selectScore + radioScore + checkboxScore;
            const isAllCorrect = s1Correct && s2Correct && s3Correct && radioCorrect && isAllChecked && noExtraChecked;

            // æ›´æ–°UI
            const feedbackEl = document.getElementById("feedback4");
            const analysisEl = document.getElementById("analysis4");
            const submitBtn = document.getElementById("submit4");
            const nextBtn = document.getElementById("next4");

            submitBtn.style.display = "none";
            feedbackEl.style.display = "block";
            if (isAllCorrect) {
                feedbackEl.innerHTML = "âœ… å…¨å¯¹ï¼ä½ æŠŠéƒ­ä¸‡åˆšçš„æ•…äº‹è¯»é€äº†~";
                feedbackEl.className = "feedback ok";
                nextBtn.classList.remove("error");
            } else {
                feedbackEl.innerHTML = `âŒ å…±å¾—${selectScore + radioScore + checkboxScore}åˆ†ï¼Œå†ä»”ç»†è¯»è¯»æ•…äº‹å§~`;
                feedbackEl.className = "feedback no";
                nextBtn.classList.add("error");
            }

            // æ˜¾ç¤ºé”™è¯¯é€‰é¡¹æ ‡è®°
            if (!s1Correct) document.getElementById("q4-1").style.borderColor = "#e74c3c";
            if (!s2Correct) document.getElementById("q4-2").style.borderColor = "#e74c3c";
            if (!s3Correct) document.getElementById("q4-3").style.borderColor = "#e74c3c";
            if (!radioCorrect && radioChecked) radioChecked.parentNode.classList.add('incorrect');

            analysisEl.style.display = "block";
            analysisEl.className = isAllCorrect ? "analysis correct" : "analysis incorrect";
            analysisEl.textContent = answerBank.q4.b.analysis;
        }

        // 9. é‡æ–°å¼€å§‹æ¸¸æˆ
        function restartGame() {
            totalScore = 0;
            dragResult = { emotion: null, number: null };
            
            // éšæœºæ’åºé¢˜ç›®é¡µé¢
            shufflePages();
            
            // é‡ç½®æ‰€æœ‰é¡µé¢çŠ¶æ€
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.getElementById('page1').classList.add('active');
            
            // é‡ç½®è¡¨å•å…ƒç´ 
            document.querySelectorAll('input, select').forEach(el => {
                if (el.type === 'radio' || el.type === 'checkbox') el.checked = false;
                else if (el.tagName === 'SELECT') el.value = '';
            });
            
            // é‡ç½®æ ·å¼
            document.querySelectorAll('.option, .drop-item, .select-group select').forEach(el => {
                el.classList.remove('correct', 'incorrect');
                if (el.tagName === 'SELECT') el.style.borderColor = '';
            });
            
            // é‡ç½®åé¦ˆä¿¡æ¯
            document.querySelectorAll('.feedback, .analysis').forEach(el => {
                el.style.display = 'none';
            });
            
            // é‡ç½®æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.btn-submit').forEach(btn => {
                btn.style.display = 'inline-block'; // æäº¤æŒ‰é’®é»˜è®¤æ˜¾ç¤º
            });
            document.querySelectorAll('.btn-next').forEach(btn => {
                btn.classList.remove('error');
            });
            
            // é‡æ–°éšæœºæ’åºæ‰€æœ‰é€‰æ‹©é¢˜é€‰é¡¹
            shuffleOptions();
        }
        
        // 10. é¡µé¢é¡ºåºéšæœºæ’åºå‡½æ•°
        function shufflePages() {
            // è·å–æ‰€æœ‰é¢˜ç›®é¡µé¢ï¼ˆä¸åŒ…æ‹¬ç»“æœé¡µï¼‰
            const pages = Array.from(document.querySelectorAll('.page:not(#page5)'));
            const container = pages[0].parentNode;
            
            // ä¿å­˜åŸå§‹é¡µé¢çš„IDæ˜ å°„
            const pageMap = {};
            pages.forEach((page, index) => {
                pageMap[page.id] = index + 1;
            });
            
            // éšæœºæ’åºé¡µé¢æ•°ç»„
            const shuffledPages = [...pages].sort(() => Math.random() - 0.5);
            
            // é‡æ–°ç¼–å·é¡µé¢IDï¼ˆä¿æŒpage1å§‹ç»ˆæ˜¯ç¬¬ä¸€ä¸ªæ˜¾ç¤ºçš„ï¼‰
            shuffledPages.forEach((page, index) => {
                const newId = `page${index + 1}`;
                // ä¿å­˜åŸå§‹é¡µé¢IDå’Œæ–°IDçš„æ˜ å°„å…³ç³»
                window.pageIdMap = window.pageIdMap || {};
                window.pageIdMap[newId] = page.id;
                page.id = newId;
            });
            
            // ç§»é™¤æ‰€æœ‰é¡µé¢
            pages.forEach(page => page.remove());
            
            // æŒ‰ç…§éšæœºé¡ºåºé‡æ–°æ·»åŠ é¡µé¢
            shuffledPages.forEach(page => container.appendChild(page));
        }
        
        // 11. é€‰é¡¹éšæœºæ’åºå‡½æ•°
        function shuffleOptions() {
            // è·å–æ‰€æœ‰é¡µé¢ä¸­çš„é€‰é¡¹ç»„
            const pages = document.querySelectorAll('.page');
            
            pages.forEach(page => {
                // å¤„ç†å•é€‰é¢˜é€‰é¡¹ï¼ˆradioæŒ‰é’®ï¼‰
                const optionGroups = page.querySelectorAll('.question-title + .option, .question-title ~ .option');
                if (optionGroups.length > 0) {
                    const parent = optionGroups[0].parentNode;
                    const optionsArray = Array.from(optionGroups);
                    
                    // éšæœºæ’åºé€‰é¡¹æ•°ç»„
                    optionsArray.sort(() => Math.random() - 0.5);
                    
                    // ä»çˆ¶èŠ‚ç‚¹ä¸­ç§»é™¤æ‰€æœ‰é€‰é¡¹
                    optionGroups.forEach(option => option.remove());
                    
                    // æŒ‰ç…§éšæœºé¡ºåºé‡æ–°æ·»åŠ é€‰é¡¹
                    optionsArray.forEach(option => parent.insertBefore(option, parent.querySelector('.feedback')));
                }
                
                // å¤„ç†å¤šé€‰é¢˜é€‰é¡¹ï¼ˆcheckboxï¼‰
                const checkboxContainer = page.querySelector('div[style*="display: flex; flex-wrap: wrap; gap: 15px;"]');
                if (checkboxContainer) {
                    const checkboxes = checkboxContainer.querySelectorAll('label');
                    const checkboxesArray = Array.from(checkboxes);
                    
                    // éšæœºæ’åºå¤šé€‰æ¡†
                    checkboxesArray.sort(() => Math.random() - 0.5);
                    
                    // ä»å®¹å™¨ä¸­ç§»é™¤æ‰€æœ‰å¤šé€‰æ¡†
                    checkboxes.forEach(cb => cb.remove());
                    
                    // æŒ‰ç…§éšæœºé¡ºåºé‡æ–°æ·»åŠ å¤šé€‰æ¡†
                    checkboxesArray.forEach(cb => checkboxContainer.appendChild(cb));
                }
                
                // å¤„ç†æ‹–æ‹½é¢˜å³è¾¹æ çš„ç­”æ¡ˆé€‰é¡¹
                const dropTarget = page.querySelector('.drop-target');
                if (dropTarget) {
                    const dropItems = dropTarget.querySelectorAll('.drop-item');
                    const dropItemsArray = Array.from(dropItems);
                    
                    // éšæœºæ’åºç­”æ¡ˆé€‰é¡¹
                    dropItemsArray.sort(() => Math.random() - 0.5);
                    
                    // ä»å®¹å™¨ä¸­ç§»é™¤æ‰€æœ‰ç­”æ¡ˆé€‰é¡¹
                    dropItems.forEach(item => item.remove());
                    
                    // æŒ‰ç…§éšæœºé¡ºåºé‡æ–°æ·»åŠ ç­”æ¡ˆé€‰é¡¹
                    dropItemsArray.forEach(item => {
                        // å°†ç­”æ¡ˆé€‰é¡¹æ·»åŠ åˆ°ç›®æ ‡åŒºåŸŸï¼ˆä¿ç•™æç¤ºæ–‡å­—åé¢ï¼‰
                        const dropHint = dropTarget.querySelector('.drop-hint');
                        if (dropHint) {
                            dropTarget.insertBefore(item, dropHint.nextSibling);
                        } else {
                            dropTarget.appendChild(item);
                        }
                    });
                }
            });
        }
        
        // é¡µé¢åŠ è½½æ—¶æ‰§è¡Œæ’åº
        window.onload = function() {
            // å…ˆéšæœºæ’åºé¡µé¢
            shufflePages();
            // å†éšæœºæ’åºé€‰é¡¹
            shuffleOptions();
        };
    </script>
    <!-- è¿”å›æŒ‰é’® -->
    <button id="back-btn" class="back-button">è¿”å›ä¸»ç•Œé¢</button>
    <script>
        // è¿”å›æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        document.getElementById('back-btn').addEventListener('click', function() {
            window.location.href = 'index.html';
        });
    </script>
</body>
</html>
